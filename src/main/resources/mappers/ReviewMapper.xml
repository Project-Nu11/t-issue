<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.toiletissue.review.model.dao.ReviewMapper">
    <resultMap id="reviewResultMap" type="com.toiletissue.review.model.dto.ReviewDTO">
        <id property="no" column="review_no"/>
        <result property="content" column="review_content"/>
        <result property="score" column="review_score"/>
        <result property="memberId" column="member_id"/>
        <result property="stationName" column="station_name"/>
        <result property="toiletLocation" column="toilet_location"/>
        <result property="date" column="review_date"/>

    </resultMap>

    <insert id="insertReview">
        insert into review
        (
        review_content,
        review_score,
        review_no,
        member_id,
        station_name,
        toilet_location,
        review_date
        )
        values
        (
        #{content},
        #{score},
        null,
        #{memberId},
        #{stationName},
        #{toiletLocation},
        date_format(now(),'%y.%m.%d')
        )
    </insert>

    <select id="selectReviewListByStation" resultMap="reviewResultMap">
        select *
          from review
         where station_name = #{stationName}
         order by review_date desc
    </select>

<!--    <select id="selectAllReview" resultMap="review">-->
<!--        select-->
<!--               review_no,-->
<!--               review_content,-->
<!--               review_score,-->
<!--               member_id,-->
<!--               station_name,-->
<!--               toilet_location,-->
<!--               review_date-->
<!--          from review-->
<!--        where review_no in (select-->
<!--        review_no-->
<!--        from declaration-->
<!--        group by review_no-->
<!--        having count(*) >2);-->
<!--    </select>-->
</mapper>