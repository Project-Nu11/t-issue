<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>회원가입</title>
    <style>
        *{box-sizing:border-box; font-family: 'Arial', sans-serif;}

        .content {
            padding: 30px 25px;
        }

        .title {
            margin: 10px 0 20px;
            font-size: 22px;
            font-weight: 700;
        }

        form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        label {
            font-size: 14px;
            font-weight: 600;
            color: #2f1a48;
        }

        .field {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .input, select {
            padding: 10px 12px;
            border: 1px solid rgba(0,0,0,.25);  /* ✅ 피그마 값 */
            border-radius: 8px;
            font-size: 14px;
            outline: none;
        }

        .input:focus, select:focus {
            border-color: rgba(0,0,0,.5);
            box-shadow: 0 0 0 3px rgba(138, 78, 191, 0.2);
        }

        .input-row {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .input-row .input {
            flex: 1;
        }

        .check-btn {
            height: 36px;
            padding: 0 14px;
            border: 1px solid rgba(0,0,0,.25);
            border-radius: 8px;
            background: #fff;
            cursor: pointer;
            font-size: 13px;
        }

        .hint {
            font-size: 12px;
            color: #666;
        }

        .actions {
            margin-top: 10px;
            display: flex;
            justify-content: flex-end;
        }

        #nextBtn {
            height: 30px;
            padding: 0 16px;
            border: 1px solid rgba(0,0,0,.25);
            border-radius: 8px;
            background: #ffffff;
            color: #000000;
            font-weight: 600;
            font-size: 13px;
            cursor: pointer;
        }
    </style>
</head>
<body>

<div th:include="/common/header.html"></div>
<div id="main">
    <div class="content">
        <p class="title">회원가입</p>

        <form th:action="@{/member/register}" method="post" th:object="${member}">
            <div class="field">
                <label for="memberId">아이디</label>
                <div class="input-row">
                    <input class="input" type="text" th:field="*{memberId}" id="memberId" />
                    <button class="check-btn" type="button" id="checkIdBtn">중복확인</button>
                </div>
                <span id="idMsg" class="hint"></span>
            </div>

            <div class="field">
                <label for="memberPwd">비밀번호</label>
                <input class="input" type="password" th:field="*{memberPwd}" id="memberPwd" />
                <p class="hint">* 영문, 숫자 포함 8자 이상</p>
            </div>

            <div class="field">
                <label for="pwdConfirm">비밀번호 확인</label>
                <input class="input" type="password" id="pwdConfirm" />
            </div>

            <div class="field">
                <label for="email">이메일</label>
                <input class="input" type="email" th:field="*{email}" id="email" />
            </div>

            <div class="field">
                <label for="memberName">이름</label>
                <input class="input" type="text" th:field="*{memberName}" id="memberName" />
            </div>

            <div class="field">
                <label for="memberBdate">생년월일</label>
                <input class="input" type="date" th:field="*{memberBdate}" id="memberBdate" />
            </div>

            <div class="field">
                <label for="memberGender">성별</label>
                <select class="input" th:field="*{memberGender}" id="memberGender">
                    <option value="M">남자</option>
                    <option value="F">여자</option>
                </select>
            </div>

            <div class="actions">
                <button id="nextBtn" type="submit">다음</button>
            </div>
        </form>
    </div>
</div>

<script>
    // 아이디 중복확인 (GET /member/register/check-id?memberId=xxx 로 가정)
    document.getElementById('checkIdBtn').addEventListener('click', async () => {
        const memberId = document.getElementById('memberId').value.trim();
        const msg = document.getElementById('idMsg');

        if (!memberId) { msg.textContent = '아이디를 입력하세요.'; msg.style.color='#a30000'; return; }

        try {
            const res = await fetch(`/member/register/check-id?memberId=${encodeURIComponent(memberId)}`);
            const data = await res.json(); // {available:true/false}

            msg.textContent = data.available ? '사용 가능한 아이디입니다.' : '이미 사용 중인 아이디입니다.';
            msg.style.color = data.available ? '#2a7a2a' : '#a30000';
        } catch {
            msg.textContent = '중복확인 API가 아직 연결되지 않았습니다.'; msg.style.color='#a30000';
        }
    });

    // 비밀번호 일치 확인
    document.getElementById('registerForm').addEventListener('submit', (e) => {
        const p1 = document.getElementById('memberPwd').value;
        const p2 = document.getElementById('pwdConfirm').value;
        const hint = document.getElementById('pwdMsg');

        if (p1 !== p2) {
            e.preventDefault();
            hint.textContent = '비밀번호가 일치하지 않습니다.';
            hint.style.color = '#a30000';
            document.getElementById('pwdConfirm').focus();
        }
    });
</script>
</body>
</html>